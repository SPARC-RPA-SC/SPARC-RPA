
Creating SPARC_INPUT_MPI datatype took 30.634 ms
Initializing ...
Checking input arguments parsed by command line.

Checking inputs parsed by commandline took 12.791 ms

Set default values took 3.593 ms
Reading input file BaTiO3_valgrind/temp_run/BaTiO3_valgrind.inpt

Reading input file took 49.250 ms
Reading ion file BaTiO3_valgrind/temp_run/BaTiO3_valgrind.ion
Number of atom types : 3.
Total number of atoms: 5.
[32m
Time for finding element is 2.381 ms
[32mElement type for atom_type Ba is Ba
[0m[32mDefault atomic mass for Ba is 137.327000
[0m[32m
Time for finding element is 0.044 ms
[32mElement type for atom_type Ti is Ti
[0m[32mDefault atomic mass for Ti is 47.867000
[0m[32m
Time for finding element is 0.040 ms
[32mElement type for atom_type O is O
[0m[32mDefault atomic mass for O is 15.999400
[0mpseudo_dir # 1 = ../../psps_tests/Ba_LDA1.psp8
pseudo_dir # 2 = ../../psps_tests/Ti_LDA1.psp8
pseudo_dir # 3 = ../../psps_tests/O_LDA1.psp8

Reading ion file took 44.180 ms
Reading pseudopotential (PSP) file.
Reading pseudopotential: psps_tests/Ba_LDA1.psp8
Input element type: Ba
pspcod = 8, pspxc = 2
Reading pseudopotential: psps_tests/Ti_LDA1.psp8
Input element type: Ti
pspcod = 8, pspxc = 2
Reading pseudopotential: psps_tests/O_LDA1.psp8
Input element type: O
pspcod = 8, pspxc = 2

Reading pseudopotential file took 814.058 ms

Freeing SPARC_INPUT_MPI datatype took 3.457 ms
Broadcasting Atom info. using MPI_Pack & MPI_Unpack in SPARC took 73.742 ms

Checking existence of (0) out file(s) took 0.570 ms


CELL_TYP: 0


Range:
    7.630000	    7.630000	    7.630000

COORD AFTER MAPPING:
    7.540463	    7.248834	    7.518607	
    3.725768	    3.878329	    3.426961	
    4.052740	    7.190115	    3.856885	
    7.090601	    3.476461	    3.727807	
    3.601708	    3.648353	    0.199860	

Max eigenvalue of -0.5*Lap is 113.0310288779912, time taken: 4.946 ms
h_eff = 0.31, npl = 25
[34m[k1_red,k2_red,k3_red] =   0.0000   0.0000   0.0000
[0mAfter symmetry reduction, Nkpts_sym = 1
k1[ 0]:   0.0000, k2[ 0]:   0.0000, k3[ 0]:   0.0000, kptwt[ 0]: 1.000 

rank = 0, Copying data from SPARC_Input into SPARC & set up subcomm took 57.934 ms
Set up communicators.

--set up spincomm took 28.543 ms

--set up kptcomm took 6.963 ms

 kpt_topo #0, kptcomm topology dims = {3, 4, 4}, nodes/proc = {8.33,6.25,6.25}

--set up bandcomm took 6.055 ms
rank = 0, dmcomm dims = {2, 2, 2}
gridsizes = [25, 25, 25], Nstates = 29, dmcomm dims = [2, 2, 2]

--set up dmcomm took 7.008 ms

--set up blacscomm took 6.048 ms
rank = 0, size_blacscomm = 6, ScaLAPACK topology Dims = (6, 1)
nproc = 48, size_blacscomm = 6 = dims[0] * dims[1] = (6, 1)
rank =  0, my blacs rank = 0, BLCYC size (2197, 5), actual size (2197, 5)
rank = 0, mb = nb = 29, mbQ = nbQ = 64
rank = 0, nr_Hp = 29, nc_Hp = 29
========================================================================
Poisson domain decomposition:np total = 48, {Nx, Ny, Nz} = {25, 25, 25}
nproc used = 48 = {3, 4, 4}, nodes/proc = {8.33, 6.25, 6.25}


--set up dmcomm_phi took 6.019 ms
======Set_D2D_Target: find receivers in each process (c_ndgrid) in send_comm took 4.537 ms
======Set_D2D_Target: Gather and Scatter receivers in send_comm took 51.185 ms

-----------------------------------------------
Parallelization summary
Total number of processors: 48
-----------------------------------------------
== Psi domain ==
Total number of processors used for Psi domain: 48
npspin  : 1
# of spin per spincomm           : 1
npkpt   : 1
# of k-points per kptcomm        : 1
npband  : 6
# of bands per bandcomm          : 5
npdomain: 8
Embeded Cartesian topology dims: (2,2,2)
# of FD-grid points per processor: 2197 = (13,13,13)
-----------------------------------------------
== Phi domain ==
Total number of processors used for Phi domain: 48
Embeded Cartesian topology dims: (3,4,4)
# of FD-grid points per processor: 441 = (9,7,7)
-----------------------------------------------

Calculate_SplineDerivRadFun took 19.732 ms
Rbmax_x = 8.552000, Rbmax_y = 8.552000, Rbmax_z = 8.552000
rlen_ex = 68921, nxp = 41, nyp = 41, nzp = 41
time spent on qsort: 13.129 ms.
time spent on vectorized spline interp: 18.852 ms.
Z = 10,rb_x = 5.765565,rb_y = 5.765565,rb_z = 5.765565,error = 1.531E-05,Bint = -10.0000153133704
Z = 10,rb_x = 7.158782,rb_y = 7.158782,rb_z = 7.158782,error = 1.579E-08,Bint = -9.9999999842062
Z = 10,rb_x = 6.462174,rb_y = 6.462174,rb_z = 6.462174,error = 3.325E-07,Bint = -9.9999996675314
Z = 10,rb_x = 6.113869,rb_y = 6.113869,rb_z = 6.113869,error = 3.077E-06,Bint = -10.0000030768915
Z = 10,rb_x = 5.939717,rb_y = 5.939717,rb_z = 5.939717,error = 1.138E-05,Bint = -10.0000113782947
dx = 0.305200, dy = 0.305200, dz = 0.305200, Ncube_x = 21, Ncube_y = 21, Ncube_z = 21
ityp = 0, converged in 5 iters, err_cur = 3.08E-06, TOL = 1.00E-05, rb = {6.113869, 6.113869, 6.113869}, after proj to grid rb = {6.409200, 6.409200, 6.409200}
time for finding rb using bisection: 87.895 ms.
time spent on vectorized spline interp: 25.153 ms.
Z = 12,rb_x = 5.514800,rb_y = 5.514800,rb_z = 5.514800,error = 9.693E-06,Bint = -12.0000096932645
Z = 12,rb_x = 3.996200,rb_y = 3.996200,rb_z = 3.996200,error = 1.652E-05,Bint = -12.0000165207579
Z = 12,rb_x = 4.755500,rb_y = 4.755500,rb_z = 4.755500,error = 1.423E-05,Bint = -12.0000142291116
Z = 12,rb_x = 5.135150,rb_y = 5.135150,rb_z = 5.135150,error = 1.280E-05,Bint = -12.0000128010627
Z = 12,rb_x = 5.324975,rb_y = 5.324975,rb_z = 5.324975,error = 1.067E-05,Bint = -12.0000106706184
dx = 0.305200, dy = 0.305200, dz = 0.305200, Ncube_x = 19, Ncube_y = 19, Ncube_z = 19
ityp = 1, converged in 5 iters, err_cur = 9.69E-06, TOL = 1.00E-05, rb = {5.514800, 5.514800, 5.514800}, after proj to grid rb = {5.798800, 5.798800, 5.798800}
time for finding rb using bisection: 62.518 ms.
time spent on vectorized spline interp: 29.284 ms.
Z = 6,rb_x = 5.012550,rb_y = 5.012550,rb_z = 5.012550,error = 1.983E-05,Bint = -6.0000198316121
Z = 6,rb_x = 6.782275,rb_y = 6.782275,rb_z = 6.782275,error = 7.944E-08,Bint = -6.0000000794406
Z = 6,rb_x = 5.897412,rb_y = 5.897412,rb_z = 5.897412,error = 1.237E-05,Bint = -6.0000123669812
Z = 6,rb_x = 6.339844,rb_y = 6.339844,rb_z = 6.339844,error = 3.442E-06,Bint = -6.0000034418279
Z = 6,rb_x = 6.118628,rb_y = 6.118628,rb_z = 6.118628,error = 3.442E-06,Bint = -6.0000034418279
dx = 0.305200, dy = 0.305200, dz = 0.305200, Ncube_x = 21, Ncube_y = 21, Ncube_z = 21
ityp = 2, converged in 5 iters, err_cur = 3.44E-06, TOL = 1.00E-05, rb = {6.118628, 6.118628, 6.118628}, after proj to grid rb = {6.409200, 6.409200, 6.409200}
time for finding rb using bisection: 53.339 ms.

Calculating rb for all atom types took 297.548 ms
----------------------
Estimated memory usage
Total: 24.08 MB
orbitals             : 20.74 MB
global sized vectors : 3.34 MB
----------------------------------------------
Estimated memory usage per processor: 513.71 kB
Start ground-state calculation.

Computing nearest neighbor distance (3.238 Bohr) takes 1.409 ms
Calculating electron density ... 
Finding atoms that influence the local process domain ... 

Finding influencing atoms took 18.868 ms
Calculating pseudocharge density ... 
the global sum of int_b = -40.0000088053934, sum_int_rho = 39.5220438817027
PosCharge = 40.000008805393, NegCharge = -39.522043881703, scal_fac = 1.012093628688
After scaling, int_rho = 40.0000088053934, PosCharge + NegCharge - NetCharge = 0.000e+00
--Calculate Vref took 22.991 ms
--Calculate rho_guess took 108.577 ms

 integral of b = -40.0000088053934,
 int{b} + Nelectron + NetCharge = -8.805e-06,
 Esc = -203.5490313617280,
 MPI_Reduce took 12.508 ms

Calculating b & b_ref took 340.570 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 24.745 ms
[0m
Finding nonlocal influencing atoms in psi-domain took 26.454 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 24.085 ms
[0m
Calculating nonlocal projectors in psi-domain took 41.321 ms
Finding atoms that has nonlocal influence on the local process domain ... 
[32mrank = 0, time for nonlocal influencing atoms: 2.139 ms
[0m
Finding nonlocal influencing atoms in kptcomm_topo took 2.982 ms
Calculate nonlocal projectors ... 
[34mrank = 0, Time for spherical harmonics: 0.771 ms
[0m
Calculating nonlocal projectors in kptcomm_topo took 4.100 ms
Initializing Kohn-Sham orbitals ... 
Finished setting random orbitals. Time taken: 9.860 ms
Initializing electron density ... 
Start SCF calculation ... 
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -40.00000880539339, int_rho =  40.00000880539339, int_b + int_rho = 0.000e+00, checking this took 2.470 ms
2-norm of RHS = 553.8943037260909, which took 2.639 ms

iter_count = 90, r_2norm = 4.974e-03, tol*||rhs|| = 5.539e-03

Anderson update took 1563.313 ms, out of which F'*F took 45.229 ms; b-Ax took 275.239 ms, out of which Lap took 272.676 ms
Solving Poisson took 1926.162 ms
rank = 0, XC calculation took 10.247 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 2.472 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 2.580 ms
======D2D: initiated sending and receiving took 25.951 ms
---Transfer Veff_loc: D2D took 38.845 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.138 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.215 ms
---Transfer Veff_loc: mpi_bcast (count = 2197) to all bandcomms took 3.131 ms
rank = 0, Veff calculation and Bcast (non-blocking) took 50.150 ms
-------------
SCF iter 1  
-------------

Time for setting up initial guess for Lanczos: 0.980 ms

Start Lanczos algorithm ...
Wait for veff to be bcasted took 0.179 ms
rank =  0, One H*x took 36.422 ms
    Lanczos iter 22, eigmin  = -1.737084254, eigmax = 112.771859580, err_eigmin = 3.908e-03, err_eigmax = 8.727e-03
rank =   0, Lanczos took 388.388 ms, eigmin = -1.737084253605, eigmax = 113.899578176172

 Chebfilt 1, in Chebyshev filtering, lambda_cutoff = 56.031247, lowerbound = -1.837084, upperbound = 113.899578

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 25): 1987.724 ms
New BLOCK CYCLIC DOMAIN: nproc = 6, dims = (6, 1), Elapsed time is 0.285 ms
rank =  0, Distribute orbital to block cyclic format took 127.979 ms
rank = 0, STARTING PDGEMM ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 551.941 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 12.599 ms
rank =  0, Distribute data + matrix mult took 694.154 ms
rank =  0, finding HY took 62.135 ms
rank =  0, distributing HY into block cyclic form took 12.059 ms
rank =  0, finding Y'*HY took 57.554 ms
Rank 0, Project_Hamiltonian used 830.897 ms
Total time for projection: 832.794 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 483.709 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 25.515 ms
rank = 0, Solve_Generalized_EigenProblem used 510.855 ms
    first calculated eigval = -0.517063735800306
    last  calculated eigval = 2.822857191472329
The last 19 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 40):
lambda[  11] =   1.44141685678744
lambda[  12] =   1.49568994632569
lambda[  13] =   1.57176225909686
lambda[  14] =   1.57892117314796
lambda[  15] =   1.75399417612623
lambda[  16] =   1.82074259172282
lambda[  17] =   1.84494810159722
lambda[  18] =   2.00505039471783
lambda[  19] =   2.04610089001518
lambda[  20] =   2.11444874398289
lambda[  21] =   2.17740945924571
lambda[  22] =   2.24976552330904
lambda[  23] =   2.31964164306637
lambda[  24] =   2.34267249878309
lambda[  25] =   2.44456785676118
lambda[  26] =   2.56306826360531
lambda[  27] =   2.63790004434745
lambda[  28] =   2.77126346263378
lambda[  29] =   2.82285719147233
==generalized eigenproblem: bcast eigvals took 0.630 ms
Total time for solving generalized eigenvalue problem: 513.086 ms
rank =  0, subspace rotation using ScaLAPACK took 100.405 ms
rank =  0, Distributing orbital back into band + domain format took 118.621 ms
rank = 0, Subspace_Rotation used 220.793 ms

Total time for subspace rotation: 222.878 ms
rank = 0, Efermi =   2.154310234898 calculate fermi energy took 15.160 ms

 Chebfilt 2, in Chebyshev filtering, lambda_cutoff = 2.922857, lowerbound = -1.837084, upperbound = 113.899578

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 25): 1544.895 ms
New BLOCK CYCLIC DOMAIN: nproc = 6, dims = (6, 1), Elapsed time is 0.029 ms
rank =  0, Distribute orbital to block cyclic format took 17.710 ms
rank = 0, STARTING PDGEMM ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 29.387 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.757 ms
rank =  0, Distribute data + matrix mult took 48.716 ms
rank =  0, finding HY took 60.584 ms
rank =  0, distributing HY into block cyclic form took 9.472 ms
rank =  0, finding Y'*HY took 30.232 ms
Rank 0, Project_Hamiltonian used 151.351 ms
Total time for projection: 151.868 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 36.198 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 10.372 ms
rank = 0, Solve_Generalized_EigenProblem used 47.292 ms
    first calculated eigval = -1.742075429632697
    last  calculated eigval = 0.800625451956264
The last 19 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 40):
lambda[  11] =  -0.02834706154022
lambda[  12] =   0.07169472532952
lambda[  13] =   0.08906227120279
lambda[  14] =   0.12614547809679
lambda[  15] =   0.14064093827262
lambda[  16] =   0.17887212544980
lambda[  17] =   0.19068344225414
lambda[  18] =   0.29106338614305
lambda[  19] =   0.31032660983563
lambda[  20] =   0.37078802354459
lambda[  21] =   0.43116630127645
lambda[  22] =   0.48949304976784
lambda[  23] =   0.51457629065414
lambda[  24] =   0.55334280258700
lambda[  25] =   0.59891208615120
lambda[  26] =   0.65992784790395
lambda[  27] =   0.67552996711877
lambda[  28] =   0.77225932850890
lambda[  29] =   0.80062545195626
==generalized eigenproblem: bcast eigvals took 3.401 ms
Total time for solving generalized eigenvalue problem: 51.297 ms
rank =  0, subspace rotation using ScaLAPACK took 29.483 ms
rank =  0, Distributing orbital back into band + domain format took 10.636 ms
rank = 0, Subspace_Rotation used 40.931 ms

Total time for subspace rotation: 41.723 ms
rank = 0, Efermi =   0.408067077020 calculate fermi energy took 1.419 ms

 Chebfilt 3, in Chebyshev filtering, lambda_cutoff = 0.900625, lowerbound = -1.837084, upperbound = 113.899578

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 25): 1587.483 ms
New BLOCK CYCLIC DOMAIN: nproc = 6, dims = (6, 1), Elapsed time is 0.024 ms
rank =  0, Distribute orbital to block cyclic format took 10.296 ms
rank = 0, STARTING PDGEMM ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 29.379 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.755 ms
rank =  0, Distribute data + matrix mult took 41.275 ms
rank =  0, finding HY took 57.633 ms
rank =  0, distributing HY into block cyclic form took 10.858 ms
rank =  0, finding Y'*HY took 30.373 ms
Rank 0, Project_Hamiltonian used 142.507 ms
Total time for projection: 142.979 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 54.021 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 8.425 ms
rank = 0, Solve_Generalized_EigenProblem used 63.175 ms
    first calculated eigval = -1.743347761708539
    last  calculated eigval = 0.597174071432581
The last 19 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 40):
lambda[  11] =  -0.13091049661203
lambda[  12] =   0.04071257772032
lambda[  13] =   0.04851401153276
lambda[  14] =   0.05023917526357
lambda[  15] =   0.05408913244664
lambda[  16] =   0.05590586967957
lambda[  17] =   0.07246307197984
lambda[  18] =   0.08332533431798
lambda[  19] =   0.09207302349646
lambda[  20] =   0.10848065670414
lambda[  21] =   0.34204819671921
lambda[  22] =   0.35737319096723
lambda[  23] =   0.37006886149359
lambda[  24] =   0.40791453163359
lambda[  25] =   0.42209109476938
lambda[  26] =   0.44572774834041
lambda[  27] =   0.48623014822889
lambda[  28] =   0.50861331621160
lambda[  29] =   0.59717407143258
==generalized eigenproblem: bcast eigvals took 0.242 ms
Total time for solving generalized eigenvalue problem: 64.027 ms
rank =  0, subspace rotation using ScaLAPACK took 27.574 ms
rank =  0, Distributing orbital back into band + domain format took 10.073 ms
rank = 0, Subspace_Rotation used 38.455 ms

Total time for subspace rotation: 39.206 ms
rank = 0, Efermi =   0.318948972351 calculate fermi energy took 0.650 ms

 Chebfilt 4, in Chebyshev filtering, lambda_cutoff = 0.697174, lowerbound = -1.837084, upperbound = 113.899578

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 25): 1582.200 ms
New BLOCK CYCLIC DOMAIN: nproc = 6, dims = (6, 1), Elapsed time is 0.024 ms
rank =  0, Distribute orbital to block cyclic format took 9.576 ms
rank = 0, STARTING PDGEMM ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 28.813 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 2.776 ms
rank =  0, Distribute data + matrix mult took 41.982 ms
rank =  0, finding HY took 58.536 ms
rank =  0, distributing HY into block cyclic form took 9.594 ms
rank =  0, finding Y'*HY took 29.990 ms
Rank 0, Project_Hamiltonian used 142.474 ms
Total time for projection: 142.958 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 39.570 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 8.917 ms
rank = 0, Solve_Generalized_EigenProblem used 49.226 ms
    first calculated eigval = -1.743347821025016
    last  calculated eigval = 0.557147713626916
The last 19 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 40):
lambda[  11] =  -0.13264536639463
lambda[  12] =   0.03477393352181
lambda[  13] =   0.04634533123687
lambda[  14] =   0.04833729543453
lambda[  15] =   0.04844422544322
lambda[  16] =   0.05311463380894
lambda[  17] =   0.06387669109164
lambda[  18] =   0.08056704474763
lambda[  19] =   0.08466988208125
lambda[  20] =   0.09123221476308
lambda[  21] =   0.33724771749733
lambda[  22] =   0.34567442302322
lambda[  23] =   0.35629645164788
lambda[  24] =   0.38840767303207
lambda[  25] =   0.39635053076486
lambda[  26] =   0.42400258124087
lambda[  27] =   0.44023642333514
lambda[  28] =   0.45809082201806
lambda[  29] =   0.55714771362692
==generalized eigenproblem: bcast eigvals took 0.264 ms
Total time for solving generalized eigenvalue problem: 50.097 ms
rank =  0, subspace rotation using ScaLAPACK took 24.964 ms
rank =  0, Distributing orbital back into band + domain format took 8.836 ms
rank = 0, Subspace_Rotation used 34.583 ms

Total time for subspace rotation: 35.530 ms
rank = 0, Efermi =   0.314148326776 calculate fermi energy took 0.506 ms
rank = 0, --- Calculate rho: sum over local bands took 2.896 ms
rank = 0, --- Calculate rho: reduce over all band groups took 2.856 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.989 ms
rank = 0, Calculating density took 9445.379 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 1.113 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 1.087 ms
======D2D: initiated sending and receiving took 5.814 ms
rank = 0, D2D took 6.948 ms
rank = 0, Transfering density took 8.350 ms
Etot    =  -132.619487667344
Eband   =   -12.815851953587
E1      =    57.821899593731
E2      =   -20.386611688265
E3      =   -27.594527699218
Exc     =   -22.057643120383
Esc     =  -203.549031361728
Entropy =    -0.000000212860
dE = 2.652e+01, dEband = 2.563e+00
rank = 0, Calculating/Estimating energy took 76.034 ms, Etot = -132.619487667, dEtot = 2.652e+01, dEband = 2.563e+00
Start applying Kerker preconditioner ...
2-norm of RHS = 42.0998725566352, which took 0.174 ms

iter_count = 54, r_2norm = 2.031e-03, tol*||rhs|| = 3.921e-03

Anderson update took 70.151 ms, out of which F'*F took 27.629 ms; b-Ax took 176.929 ms, out of which Lap took 175.728 ms
rank = 0, Mixing (+ precond) took 288.415 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -40.00000880539339, int_rho =  40.00000880539341, int_b + int_rho = 1.293e-14, checking this took 0.823 ms
2-norm of RHS = 550.5652067633087, which took 0.168 ms

iter_count = 66, r_2norm = 3.037e-03, tol*||rhs|| = 5.506e-03

Anderson update took 84.766 ms, out of which F'*F took 30.508 ms; b-Ax took 176.748 ms, out of which Lap took 175.344 ms
Solving Poisson took 281.843 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.028 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.031 ms
======D2D: initiated sending and receiving took 1.224 ms
---Transfer Veff_loc: D2D took 7.974 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.004 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.004 ms
---Transfer Veff_loc: mpi_bcast (count = 2197) to all bandcomms took 1.918 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 12.177 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 12.177 ms

This SCF took 10160.071 ms, scf error = 1.582e-01
-------------
SCF iter 2  
-------------

 Chebfilt 5, in Chebyshev filtering, lambda_cutoff = 0.657148, lowerbound = -1.743348, upperbound = 113.899578

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 25): 1501.867 ms
New BLOCK CYCLIC DOMAIN: nproc = 6, dims = (6, 1), Elapsed time is 0.023 ms
rank =  0, Distribute orbital to block cyclic format took 7.671 ms
rank = 0, STARTING PDGEMM ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 32.379 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.765 ms
rank =  0, Distribute data + matrix mult took 41.636 ms
rank =  0, finding HY took 58.986 ms
rank =  0, distributing HY into block cyclic form took 13.090 ms
rank =  0, finding Y'*HY took 30.035 ms
Rank 0, Project_Hamiltonian used 146.149 ms
Total time for projection: 146.614 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 36.732 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 9.713 ms
rank = 0, Solve_Generalized_EigenProblem used 47.171 ms
    first calculated eigval = -1.830028173128460
    last  calculated eigval = 0.529372513666441
The last 19 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 40):
lambda[  11] =  -0.13903482892368
lambda[  12] =   0.08888384602594
lambda[  13] =   0.10122418183962
lambda[  14] =   0.10365546925306
lambda[  15] =   0.11074437425361
lambda[  16] =   0.11234755870943
lambda[  17] =   0.13225757113250
lambda[  18] =   0.14384293672981
lambda[  19] =   0.14888438194775
lambda[  20] =   0.15988231323436
lambda[  21] =   0.29999541798495
lambda[  22] =   0.31280660125792
lambda[  23] =   0.32420544448064
lambda[  24] =   0.37676031982713
lambda[  25] =   0.38528667230419
lambda[  26] =   0.39601777529375
lambda[  27] =   0.40171518204271
lambda[  28] =   0.44559573345673
lambda[  29] =   0.52937251366644
==generalized eigenproblem: bcast eigvals took 0.243 ms
Total time for solving generalized eigenvalue problem: 48.018 ms
rank =  0, subspace rotation using ScaLAPACK took 25.460 ms
rank =  0, Distributing orbital back into band + domain format took 6.970 ms
rank = 0, Subspace_Rotation used 33.211 ms

Total time for subspace rotation: 33.970 ms
rank = 0, Efermi =   0.276896193019 calculate fermi energy took 0.846 ms
rank = 0, --- Calculate rho: sum over local bands took 0.804 ms
rank = 0, --- Calculate rho: reduce over all band groups took 1.770 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.040 ms
rank = 0, Calculating density took 1743.278 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.033 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.037 ms
======D2D: initiated sending and receiving took 1.520 ms
rank = 0, D2D took 1.941 ms
rank = 0, Transfering density took 2.209 ms
Etot    =  -131.649091740682
Eband   =   -11.970102926027
E1      =    57.079731216302
E2      =   -20.477496585288
E3      =   -27.869392581089
Exc     =   -21.556577622759
Esc     =  -203.549031361728
Entropy =    -0.000000212847
dE = 1.941e-01, dEband = 1.691e-01
rank = 0, Calculating/Estimating energy took 42.061 ms, Etot = -131.649091741, dEtot = 1.941e-01, dEband = 1.691e-01
Start applying Kerker preconditioner ...
2-norm of RHS = 15.6137798100421, which took 0.226 ms

iter_count = 54, r_2norm = 1.277e-03, tol*||rhs|| = 1.454e-03

Anderson update took 74.311 ms, out of which F'*F took 24.929 ms; b-Ax took 142.564 ms, out of which Lap took 141.353 ms
rank = 0, Mixing (+ precond) took 252.189 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -40.00000880539339, int_rho =  40.00000880539339, int_b + int_rho = 0.000e+00, checking this took 0.179 ms
2-norm of RHS = 551.2434803231439, which took 0.151 ms

iter_count = 60, r_2norm = 3.856e-03, tol*||rhs|| = 5.512e-03

Anderson update took 72.134 ms, out of which F'*F took 24.801 ms; b-Ax took 144.912 ms, out of which Lap took 143.654 ms
Solving Poisson took 231.513 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.029 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.031 ms
======D2D: initiated sending and receiving took 1.261 ms
---Transfer Veff_loc: D2D took 2.336 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.003 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.003 ms
---Transfer Veff_loc: mpi_bcast (count = 2197) to all bandcomms took 2.477 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.346 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 6.346 ms

This SCF took 2286.636 ms, scf error = 5.330e-02
-------------
SCF iter 3  
-------------

 Chebfilt 6, in Chebyshev filtering, lambda_cutoff = 0.629373, lowerbound = -1.830028, upperbound = 113.899578

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 25): 1557.560 ms
New BLOCK CYCLIC DOMAIN: nproc = 6, dims = (6, 1), Elapsed time is 0.023 ms
rank =  0, Distribute orbital to block cyclic format took 6.845 ms
rank = 0, STARTING PDGEMM ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 29.577 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.799 ms
rank =  0, Distribute data + matrix mult took 38.026 ms
rank =  0, finding HY took 59.168 ms
rank =  0, distributing HY into block cyclic form took 7.708 ms
rank =  0, finding Y'*HY took 29.963 ms
Rank 0, Project_Hamiltonian used 137.200 ms
Total time for projection: 137.679 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 36.136 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 9.128 ms
rank = 0, Solve_Generalized_EigenProblem used 45.983 ms
    first calculated eigval = -1.844319669595943
    last  calculated eigval = 0.520969099767111
The last 19 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 40):
lambda[  11] =  -0.14685391976944
lambda[  12] =   0.10717524179763
lambda[  13] =   0.11878824918795
lambda[  14] =   0.12158015241870
lambda[  15] =   0.12868233444221
lambda[  16] =   0.13014338739807
lambda[  17] =   0.15298004841207
lambda[  18] =   0.16388907599003
lambda[  19] =   0.16932694990688
lambda[  20] =   0.18247930268445
lambda[  21] =   0.29542610959003
lambda[  22] =   0.30983648172226
lambda[  23] =   0.32261992215797
lambda[  24] =   0.37288372842378
lambda[  25] =   0.38267963238148
lambda[  26] =   0.39236249329507
lambda[  27] =   0.39484788153736
lambda[  28] =   0.44790401228309
lambda[  29] =   0.52096909976711
==generalized eigenproblem: bcast eigvals took 0.252 ms
Total time for solving generalized eigenvalue problem: 46.838 ms
rank =  0, subspace rotation using ScaLAPACK took 24.577 ms
rank =  0, Distributing orbital back into band + domain format took 7.823 ms
rank = 0, Subspace_Rotation used 33.175 ms

Total time for subspace rotation: 33.942 ms
rank = 0, Efermi =   0.272326885173 calculate fermi energy took 0.373 ms
rank = 0, --- Calculate rho: sum over local bands took 0.818 ms
rank = 0, --- Calculate rho: reduce over all band groups took 1.723 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.046 ms
rank = 0, Calculating density took 1787.525 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.033 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.030 ms
======D2D: initiated sending and receiving took 1.491 ms
rank = 0, D2D took 1.912 ms
rank = 0, Transfering density took 2.173 ms
Etot    =  -131.431521599097
Eband   =   -11.645757440272
E1      =    56.907452105487
E2      =   -20.331315392859
E3      =   -27.953681230847
Exc     =   -21.429181313443
Esc     =  -203.549031361728
Entropy =    -0.000000212847
dE = 4.351e-02, dEband = 6.487e-02
rank = 0, Calculating/Estimating energy took 65.964 ms, Etot = -131.431521599, dEtot = 4.351e-02, dEband = 6.487e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 7.1041244528965, which took 0.216 ms

iter_count = 54, r_2norm = 4.755e-04, tol*||rhs|| = 6.617e-04

Anderson update took 67.571 ms, out of which F'*F took 19.911 ms; b-Ax took 125.791 ms, out of which Lap took 124.642 ms
rank = 0, Mixing (+ precond) took 214.524 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -40.00000880539339, int_rho =  40.00000880539338, int_b + int_rho = -1.939e-14, checking this took 0.169 ms
2-norm of RHS = 554.3778662578271, which took 0.159 ms

iter_count = 60, r_2norm = 5.056e-03, tol*||rhs|| = 5.544e-03

Anderson update took 69.139 ms, out of which F'*F took 22.369 ms; b-Ax took 145.654 ms, out of which Lap took 144.378 ms
Solving Poisson took 230.246 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.026 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.030 ms
======D2D: initiated sending and receiving took 1.186 ms
---Transfer Veff_loc: D2D took 3.716 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.003 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.003 ms
---Transfer Veff_loc: mpi_bcast (count = 2197) to all bandcomms took 2.350 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 7.584 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 7.584 ms

This SCF took 2316.286 ms, scf error = 3.839e-02
-------------
SCF iter 4  
-------------

 Chebfilt 7, in Chebyshev filtering, lambda_cutoff = 0.620969, lowerbound = -1.844320, upperbound = 113.899578

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 25): 1533.229 ms
New BLOCK CYCLIC DOMAIN: nproc = 6, dims = (6, 1), Elapsed time is 0.025 ms
rank =  0, Distribute orbital to block cyclic format took 8.025 ms
rank = 0, STARTING PDGEMM ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 29.062 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.696 ms
rank =  0, Distribute data + matrix mult took 38.601 ms
rank =  0, finding HY took 59.170 ms
rank =  0, distributing HY into block cyclic form took 7.745 ms
rank =  0, finding Y'*HY took 30.687 ms
Rank 0, Project_Hamiltonian used 138.521 ms
Total time for projection: 139.005 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 36.098 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 9.893 ms
rank = 0, Solve_Generalized_EigenProblem used 46.709 ms
    first calculated eigval = -1.796097612198088
    last  calculated eigval = 0.518506852822735
The last 19 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 40):
lambda[  11] =  -0.15948939684470
lambda[  12] =   0.11425378619529
lambda[  13] =   0.12280199549080
lambda[  14] =   0.12651136437602
lambda[  15] =   0.13320306352739
lambda[  16] =   0.13552524154039
lambda[  17] =   0.15532680113753
lambda[  18] =   0.17018860945069
lambda[  19] =   0.17418849740382
lambda[  20] =   0.18619210287327
lambda[  21] =   0.31865796460733
lambda[  22] =   0.33140627871418
lambda[  23] =   0.34615978592241
lambda[  24] =   0.37742285497677
lambda[  25] =   0.37878231140723
lambda[  26] =   0.40991366722507
lambda[  27] =   0.42184084494824
lambda[  28] =   0.44643186034387
lambda[  29] =   0.51850685282274
==generalized eigenproblem: bcast eigvals took 0.247 ms
Total time for solving generalized eigenvalue problem: 47.558 ms
rank =  0, subspace rotation using ScaLAPACK took 24.907 ms
rank =  0, Distributing orbital back into band + domain format took 11.015 ms
rank = 0, Subspace_Rotation used 36.736 ms

Total time for subspace rotation: 37.507 ms
rank = 0, Efermi =   0.295558739586 calculate fermi energy took 0.448 ms
rank = 0, --- Calculate rho: sum over local bands took 0.787 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.994 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.044 ms
rank = 0, Calculating density took 1770.836 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.031 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.033 ms
======D2D: initiated sending and receiving took 1.463 ms
rank = 0, D2D took 1.876 ms
rank = 0, Transfering density took 2.135 ms
Etot    =  -131.451893947933
Eband   =   -11.283167555921
E1      =    56.911474382339
E2      =   -19.966545922010
E3      =   -27.974356272981
Exc     =   -21.472071394766
Esc     =  -203.549031361728
Entropy =    -0.000000212847
dE = 4.074e-03, dEband = 7.252e-02
rank = 0, Calculating/Estimating energy took 57.064 ms, Etot = -131.451893948, dEtot = 4.074e-03, dEband = 7.252e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 2.4667899457320, which took 0.171 ms

iter_count = 54, r_2norm = 1.674e-04, tol*||rhs|| = 2.298e-04

Anderson update took 64.204 ms, out of which F'*F took 20.829 ms; b-Ax took 129.621 ms, out of which Lap took 128.427 ms
rank = 0, Mixing (+ precond) took 225.335 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -40.00000880539339, int_rho =  40.00000880539338, int_b + int_rho = -1.293e-14, checking this took 0.171 ms
2-norm of RHS = 554.9296768174460, which took 0.157 ms

iter_count = 60, r_2norm = 2.220e-03, tol*||rhs|| = 5.549e-03

Anderson update took 72.499 ms, out of which F'*F took 24.317 ms; b-Ax took 143.650 ms, out of which Lap took 142.389 ms
Solving Poisson took 231.118 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.029 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.029 ms
======D2D: initiated sending and receiving took 1.223 ms
---Transfer Veff_loc: D2D took 2.726 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.003 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.003 ms
---Transfer Veff_loc: mpi_bcast (count = 2197) to all bandcomms took 5.923 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 12.076 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 12.076 ms

This SCF took 2306.855 ms, scf error = 3.176e-02
-------------
SCF iter 5  
-------------

 Chebfilt 8, in Chebyshev filtering, lambda_cutoff = 0.618507, lowerbound = -1.796098, upperbound = 113.899578

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 25): 1490.923 ms
New BLOCK CYCLIC DOMAIN: nproc = 6, dims = (6, 1), Elapsed time is 0.024 ms
rank =  0, Distribute orbital to block cyclic format took 7.577 ms
rank = 0, STARTING PDGEMM ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 28.982 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 1.021 ms
rank =  0, Distribute data + matrix mult took 38.392 ms
rank =  0, finding HY took 57.848 ms
rank =  0, distributing HY into block cyclic form took 9.625 ms
rank =  0, finding Y'*HY took 30.209 ms
Rank 0, Project_Hamiltonian used 138.462 ms
Total time for projection: 138.952 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 36.165 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 7.717 ms
rank = 0, Solve_Generalized_EigenProblem used 44.605 ms
    first calculated eigval = -1.806906627288598
    last  calculated eigval = 0.513970702017614
The last 19 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 40):
lambda[  11] =  -0.16522809540724
lambda[  12] =   0.12544109046855
lambda[  13] =   0.13348228905643
lambda[  14] =   0.13748843094143
lambda[  15] =   0.14443869612799
lambda[  16] =   0.14716094658870
lambda[  17] =   0.16830687931178
lambda[  18] =   0.18250813792696
lambda[  19] =   0.18675173360459
lambda[  20] =   0.19979968529611
lambda[  21] =   0.31532285319472
lambda[  22] =   0.32952171496745
lambda[  23] =   0.34462934323762
lambda[  24] =   0.37628925820066
lambda[  25] =   0.37742511631485
lambda[  26] =   0.40640153201434
lambda[  27] =   0.41936289371074
lambda[  28] =   0.44893701468634
lambda[  29] =   0.51397070201761
==generalized eigenproblem: bcast eigvals took 0.243 ms
Total time for solving generalized eigenvalue problem: 45.457 ms
rank =  0, subspace rotation using ScaLAPACK took 24.027 ms
rank =  0, Distributing orbital back into band + domain format took 7.538 ms
rank = 0, Subspace_Rotation used 32.362 ms

Total time for subspace rotation: 33.267 ms
rank = 0, Efermi =   0.292223628754 calculate fermi energy took 0.486 ms
rank = 0, --- Calculate rho: sum over local bands took 0.850 ms
rank = 0, --- Calculate rho: reduce over all band groups took 2.758 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.050 ms
rank = 0, Calculating density took 1720.966 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.033 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.032 ms
======D2D: initiated sending and receiving took 1.484 ms
rank = 0, D2D took 1.914 ms
rank = 0, Transfering density took 2.173 ms
Etot    =  -131.320528045700
Eband   =   -11.104839827157
E1      =    56.835601380371
E2      =   -19.860620235862
E3      =   -28.025151393558
Exc     =   -21.388029653759
Esc     =  -203.549031361728
Entropy =    -0.000000212847
dE = 2.627e-02, dEband = 3.567e-02
rank = 0, Calculating/Estimating energy took 4.798 ms, Etot = -131.320528046, dEtot = 2.627e-02, dEband = 3.567e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 1.4937883278575, which took 0.201 ms

iter_count = 54, r_2norm = 7.568e-05, tol*||rhs|| = 1.391e-04

Anderson update took 66.504 ms, out of which F'*F took 21.084 ms; b-Ax took 125.574 ms, out of which Lap took 124.447 ms
rank = 0, Mixing (+ precond) took 214.189 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -40.00000880539339, int_rho =  40.00000880539339, int_b + int_rho = 0.000e+00, checking this took 0.169 ms
2-norm of RHS = 555.3049202778560, which took 0.151 ms

iter_count = 54, r_2norm = 2.891e-03, tol*||rhs|| = 5.553e-03

Anderson update took 69.560 ms, out of which F'*F took 19.866 ms; b-Ax took 128.672 ms, out of which Lap took 127.514 ms
Solving Poisson took 212.223 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.025 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.030 ms
======D2D: initiated sending and receiving took 1.209 ms
---Transfer Veff_loc: D2D took 2.215 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.003 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.003 ms
---Transfer Veff_loc: mpi_bcast (count = 2197) to all bandcomms took 4.847 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 10.545 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 10.545 ms

This SCF took 2173.209 ms, scf error = 8.997e-03
-------------
SCF iter 6  
-------------

 Chebfilt 9, in Chebyshev filtering, lambda_cutoff = 0.613971, lowerbound = -1.806907, upperbound = 113.899578

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 25): 1501.561 ms
New BLOCK CYCLIC DOMAIN: nproc = 6, dims = (6, 1), Elapsed time is 0.026 ms
rank =  0, Distribute orbital to block cyclic format took 6.608 ms
rank = 0, STARTING PDGEMM ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 29.126 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.737 ms
rank =  0, Distribute data + matrix mult took 37.292 ms
rank =  0, finding HY took 59.463 ms
rank =  0, distributing HY into block cyclic form took 7.620 ms
rank =  0, finding Y'*HY took 32.125 ms
Rank 0, Project_Hamiltonian used 138.822 ms
Total time for projection: 139.266 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 37.194 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 7.591 ms
rank = 0, Solve_Generalized_EigenProblem used 45.507 ms
    first calculated eigval = -1.813101858240885
    last  calculated eigval = 0.512207580119484
The last 19 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 40):
lambda[  11] =  -0.16713336724022
lambda[  12] =   0.12557754958843
lambda[  13] =   0.13366593606225
lambda[  14] =   0.13757913205837
lambda[  15] =   0.14478260529269
lambda[  16] =   0.14749987882949
lambda[  17] =   0.16881760336773
lambda[  18] =   0.18231473394368
lambda[  19] =   0.18652485415675
lambda[  20] =   0.19986529960088
lambda[  21] =   0.31326497799355
lambda[  22] =   0.32765703302460
lambda[  23] =   0.34278825886674
lambda[  24] =   0.37633122294567
lambda[  25] =   0.37710069797810
lambda[  26] =   0.40381827249367
lambda[  27] =   0.41640975004039
lambda[  28] =   0.44932740469135
lambda[  29] =   0.51220758011948
==generalized eigenproblem: bcast eigvals took 0.243 ms
Total time for solving generalized eigenvalue problem: 46.366 ms
rank =  0, subspace rotation using ScaLAPACK took 23.763 ms
rank =  0, Distributing orbital back into band + domain format took 7.042 ms
rank = 0, Subspace_Rotation used 31.589 ms

Total time for subspace rotation: 32.371 ms
rank = 0, Efermi =   0.290165753575 calculate fermi energy took 0.568 ms
rank = 0, --- Calculate rho: sum over local bands took 0.818 ms
rank = 0, --- Calculate rho: reduce over all band groups took 3.204 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.049 ms
rank = 0, Calculating density took 1732.415 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.030 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.031 ms
======D2D: initiated sending and receiving took 1.503 ms
rank = 0, D2D took 1.935 ms
rank = 0, Transfering density took 2.197 ms
Etot    =  -131.341657802300
Eband   =   -11.158596198837
E1      =    56.916654058343
E2      =   -19.838173847950
E3      =   -28.008133952476
Exc     =   -21.396991887657
Esc     =  -203.549031361728
Entropy =    -0.000000212847
dE = 4.226e-03, dEband = 1.075e-02
rank = 0, Calculating/Estimating energy took 4.805 ms, Etot = -131.341657802, dEtot = 4.226e-03, dEband = 1.075e-02
Start applying Kerker preconditioner ...
2-norm of RHS = 0.5687576957347, which took 0.203 ms

iter_count = 54, r_2norm = 3.103e-05, tol*||rhs|| = 5.298e-05

Anderson update took 70.077 ms, out of which F'*F took 20.604 ms; b-Ax took 128.860 ms, out of which Lap took 127.705 ms
rank = 0, Mixing (+ precond) took 223.227 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -40.00000880539339, int_rho =  40.00000880539340, int_b + int_rho = 6.464e-15, checking this took 0.167 ms
2-norm of RHS = 555.2984583461747, which took 0.155 ms

iter_count = 48, r_2norm = 2.702e-03, tol*||rhs|| = 5.553e-03

Anderson update took 58.340 ms, out of which F'*F took 17.284 ms; b-Ax took 111.260 ms, out of which Lap took 110.220 ms
Solving Poisson took 178.773 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.026 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.038 ms
======D2D: initiated sending and receiving took 1.215 ms
---Transfer Veff_loc: D2D took 2.404 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.003 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.003 ms
---Transfer Veff_loc: mpi_bcast (count = 2197) to all bandcomms took 4.262 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 11.488 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 11.488 ms

This SCF took 2161.181 ms, scf error = 3.913e-03
-------------
SCF iter 7  
-------------

 Chebfilt 10, in Chebyshev filtering, lambda_cutoff = 0.612208, lowerbound = -1.813102, upperbound = 113.899578

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 25): 1522.324 ms
New BLOCK CYCLIC DOMAIN: nproc = 6, dims = (6, 1), Elapsed time is 0.026 ms
rank =  0, Distribute orbital to block cyclic format took 6.701 ms
rank = 0, STARTING PDGEMM ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 29.422 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.711 ms
rank =  0, Distribute data + matrix mult took 37.660 ms
rank =  0, finding HY took 59.196 ms
rank =  0, distributing HY into block cyclic form took 7.954 ms
rank =  0, finding Y'*HY took 30.635 ms
Rank 0, Project_Hamiltonian used 137.841 ms
Total time for projection: 138.384 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 36.651 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 7.339 ms
rank = 0, Solve_Generalized_EigenProblem used 44.703 ms
    first calculated eigval = -1.814960546107756
    last  calculated eigval = 0.511181680901790
The last 19 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 40):
lambda[  11] =  -0.16843359555667
lambda[  12] =   0.12787442250737
lambda[  13] =   0.13585017498748
lambda[  14] =   0.13969088205248
lambda[  15] =   0.14680931010426
lambda[  16] =   0.14966973733838
lambda[  17] =   0.17132884552748
lambda[  18] =   0.18479329637626
lambda[  19] =   0.18906911125879
lambda[  20] =   0.20274375852810
lambda[  21] =   0.31286312708680
lambda[  22] =   0.32758841892201
lambda[  23] =   0.34269435468091
lambda[  24] =   0.37620065090352
lambda[  25] =   0.37698009785129
lambda[  26] =   0.40343031322189
lambda[  27] =   0.41614968059932
lambda[  28] =   0.45001620369923
lambda[  29] =   0.51118168090179
==generalized eigenproblem: bcast eigvals took 0.250 ms
Total time for solving generalized eigenvalue problem: 45.563 ms
rank =  0, subspace rotation using ScaLAPACK took 23.719 ms
rank =  0, Distributing orbital back into band + domain format took 6.951 ms
rank = 0, Subspace_Rotation used 31.463 ms

Total time for subspace rotation: 32.302 ms
rank = 0, Efermi =   0.289763902694 calculate fermi energy took 0.538 ms
rank = 0, --- Calculate rho: sum over local bands took 0.757 ms
rank = 0, --- Calculate rho: reduce over all band groups took 2.957 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.048 ms
rank = 0, Calculating density took 1751.124 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.042 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.031 ms
======D2D: initiated sending and receiving took 1.491 ms
rank = 0, D2D took 1.908 ms
rank = 0, Transfering density took 2.167 ms
Etot    =  -131.316764330925
Eband   =   -11.122471600484
E1      =    56.894948030457
E2      =   -19.821278487412
E3      =   -28.018469978424
Exc     =   -21.379957652159
Esc     =  -203.549031361728
Entropy =    -0.000000212847
dE = 4.979e-03, dEband = 7.225e-03
rank = 0, Calculating/Estimating energy took 5.988 ms, Etot = -131.316764331, dEtot = 4.979e-03, dEband = 7.225e-03
Start applying Kerker preconditioner ...
2-norm of RHS = 0.2604431641572, which took 0.206 ms

iter_count = 54, r_2norm = 1.290e-05, tol*||rhs|| = 2.426e-05

Anderson update took 67.562 ms, out of which F'*F took 20.226 ms; b-Ax took 153.740 ms, out of which Lap took 152.587 ms
rank = 0, Mixing (+ precond) took 270.605 ms
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -40.00000880539339, int_rho =  40.00000880539338, int_b + int_rho = -1.293e-14, checking this took 0.309 ms
2-norm of RHS = 555.2413877467031, which took 0.186 ms

iter_count = 36, r_2norm = 4.824e-03, tol*||rhs|| = 5.552e-03

Anderson update took 42.964 ms, out of which F'*F took 13.226 ms; b-Ax took 81.082 ms, out of which Lap took 80.263 ms
Solving Poisson took 135.572 ms
Transmitting Veff_loc from phi-domain to psi-domain (LOCAL) ...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.028 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.032 ms
======D2D: initiated sending and receiving took 1.189 ms
---Transfer Veff_loc: D2D took 2.516 ms
---Transfer Veff_loc: bcast btw/ spincomms of 1st kptcomm took 0.003 ms
---Transfer Veff_loc: bcast btw/ kptcomms of 1st bandcomm took 0.003 ms
---Transfer Veff_loc: mpi_bcast (count = 2197) to all bandcomms took 4.221 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 10.367 ms
rank = 0, Transfering Veff from phi-domain to psi-domain took 10.367 ms

This SCF took 2184.274 ms, scf error = 2.422e-03
-------------
SCF iter 8  
-------------

 Chebfilt 11, in Chebyshev filtering, lambda_cutoff = 0.611182, lowerbound = -1.814961, upperbound = 113.899578

Start Chebyshev filtering ... 
Total time for Chebyshev filtering (5 columns, degree = 25): 1488.463 ms
New BLOCK CYCLIC DOMAIN: nproc = 6, dims = (6, 1), Elapsed time is 0.024 ms
rank =  0, Distribute orbital to block cyclic format took 11.522 ms
rank = 0, STARTING PDGEMM ...
rank =  0, Psi'*Psi in block cyclic format in each blacscomm took 29.427 ms
rank =  0, Allreduce to sum Psi'*Psi over dmcomm took 0.808 ms
rank =  0, Distribute data + matrix mult took 42.610 ms
rank =  0, finding HY took 59.500 ms
rank =  0, distributing HY into block cyclic form took 8.042 ms
rank =  0, finding Y'*HY took 30.413 ms
Rank 0, Project_Hamiltonian used 142.938 ms
Total time for projection: 143.470 ms
Start solving generalized eigenvalue problem ...
==generalized eigenproblem: info = 0, solving generalized eigenproblem using LAPACKE_dsygvd: 36.436 ms
==generalized eigenproblem: distribute subspace eigenvectors into block cyclic format: 7.535 ms
rank = 0, Solve_Generalized_EigenProblem used 44.686 ms
    first calculated eigval = -1.812914307586485
    last  calculated eigval = 0.511002410294626
The last 19 eigenvalues of kpoints #1 and spin #0 are (Nelectron = 40):
lambda[  11] =  -0.16893074749597
lambda[  12] =   0.12801566493160
lambda[  13] =   0.13590005992198
lambda[  14] =   0.13974806130145
lambda[  15] =   0.14687088385542
lambda[  16] =   0.14976435639653
lambda[  17] =   0.17130986393929
lambda[  18] =   0.18492798330198
lambda[  19] =   0.18912889996504
lambda[  20] =   0.20277634330422
lambda[  21] =   0.31391162005378
lambda[  22] =   0.32856313691880
lambda[  23] =   0.34367911497737
lambda[  24] =   0.37606972429471
lambda[  25] =   0.37702710909127
lambda[  26] =   0.40451658961494
lambda[  27] =   0.41741292878980
lambda[  28] =   0.45008358036690
lambda[  29] =   0.51100241029463
==generalized eigenproblem: bcast eigvals took 0.254 ms
Total time for solving generalized eigenvalue problem: 45.547 ms
rank =  0, subspace rotation using ScaLAPACK took 23.695 ms
rank =  0, Distributing orbital back into band + domain format took 7.295 ms
rank = 0, Subspace_Rotation used 31.771 ms

Total time for subspace rotation: 32.581 ms
rank = 0, Efermi =   0.290812395657 calculate fermi energy took 0.555 ms
rank = 0, --- Calculate rho: sum over local bands took 0.765 ms
rank = 0, --- Calculate rho: reduce over all band groups took 2.779 ms
rank = 0, --- Scale rho: scale by 1/dV took 0.043 ms
rank = 0, Calculating density took 1722.416 ms
rank = 0, starting to transfer density...
======D2D: find receivers' coords in each process (c_ndgrid) in send_comm took 0.034 ms
======D2D: finished initiating send_comm! Start entering receivers comm
======D2D: find senders' coords in each process (c_ndgrid) in recv_comm took 0.031 ms
======D2D: initiated sending and receiving took 1.484 ms
rank = 0, D2D took 1.910 ms
rank = 0, Transfering density took 2.169 ms
Etot    =  -131.318264003097
Eband   =   -11.110296374824
E1      =    56.886861003876
E2      =   -19.816962344272
E3      =   -28.018667474470
Exc     =   -21.381426876316
Esc     =  -203.549031361728
Entropy =    -0.000000212847
dE = 2.999e-04, dEband = 2.435e-03
rank = 0, Calculating/Estimating energy took 63.356 ms, Etot = -131.318264003, dEtot = 2.999e-04, dEband = 2.435e-03

This SCF took 1789.507 ms, scf error = 6.400e-04
Start calculating electrostatic potential ... 
Start calculating rhs of the poisson problem
rank = 0, int_b = -40.00000880539339, int_rho =  40.00000880539341, int_b + int_rho = 1.293e-14, checking this took 0.192 ms
2-norm of RHS = 555.2378779173346, which took 0.160 ms

iter_count = 42, r_2norm = 2.791e-03, tol*||rhs|| = 5.552e-03

Anderson update took 51.395 ms, out of which F'*F took 15.552 ms; b-Ax took 99.795 ms, out of which Lap took 98.870 ms
Solving Poisson took 159.877 ms
Etot    =  -131.331386830923
Eband   =   -11.110296374824
E1      =    56.882000107074
E2      =   -19.810143900795
E3      =   -28.017223986923
Exc     =   -21.381426876316
Esc     =  -203.549031361728
Entropy =    -0.000000212847
dE = 2.625e-03, dEband = 0.000e+00
The last 19 occupations of kpoints #1 are (Nelectron = 40):
lambda[  11] =  -0.16893074749597, occ[  11] =   2.00000000000000
lambda[  12] =   0.12801566493160, occ[  12] =   2.00000000000000
lambda[  13] =   0.13590005992198, occ[  13] =   2.00000000000000
lambda[  14] =   0.13974806130145, occ[  14] =   2.00000000000000
lambda[  15] =   0.14687088385542, occ[  15] =   2.00000000000000
lambda[  16] =   0.14976435639653, occ[  16] =   2.00000000000000
lambda[  17] =   0.17130986393929, occ[  17] =   2.00000000000000
lambda[  18] =   0.18492798330198, occ[  18] =   2.00000000000000
lambda[  19] =   0.18912889996504, occ[  19] =   2.00000000000000
lambda[  20] =   0.20277634330422, occ[  20] =   2.00000000000000
lambda[  21] =   0.31391162005378, occ[  21] =   0.00000880539302
lambda[  22] =   0.32856313691880, occ[  22] =   0.00000000000038
lambda[  23] =   0.34367911497737, occ[  23] =   0.00000000000000
lambda[  24] =   0.37606972429471, occ[  24] =   0.00000000000000
lambda[  25] =   0.37702710909127, occ[  25] =   0.00000000000000
lambda[  26] =   0.40451658961494, occ[  26] =   0.00000000000000
lambda[  27] =   0.41741292878980, occ[  27] =   0.00000000000000
lambda[  28] =   0.45008358036690, occ[  28] =   0.00000000000000
lambda[  29] =   0.51100241029463, occ[  29] =   0.00000000000000

k = [0.000, 0.000, 0.000]
Occupation of state 26 (90%) = 0.000000000000000.
Occupation of state 29 (100%) = 0.000000000000000.
Start calculating local components of forces ...
time for sorting and interpolate pseudopotential: 25.950 ms, time for Allreduce/Reduce: 0.456 ms 
Time for calculating local force components: 265.151 ms
Start Calculating nonlocal forces
force_nloc = 
 -0.00353514021361   0.00814944744514   0.01864131959104
  0.00387582371870  -0.01095137764646  -0.00223502567019
 -0.19307152536657  -0.18558949983276  -0.21436596024347
  0.02382168275824   0.22907607542226  -0.18053591679549
  0.05378386147936   0.11507752084627   0.16205483951562
force_loc = 
 -0.00037947603954  -0.00719503330175  -0.04486166826423
  0.08779002271223   0.19584702206370  -0.17532583542783
  0.20423937165835   0.11055150320575   0.29655353320156
 -0.06118798479802  -0.31282265419130   0.23838721310990
 -0.12019271216806  -0.14474160339071  -0.09345397494479
Time for calculating nonlocal force components: 216.157 ms
 Cartesian force = 
 -0.00294340100136   0.00147413401936  -0.02719205348761
  0.09263706168272   0.18541536429321  -0.17853256591245
  0.01213906154356  -0.07451827675103   0.08121586814367
 -0.03639508678800  -0.08322685889307   0.05687959149998
 -0.06543763543692  -0.02914436266847   0.06762915975641
Start calculating exchange-correlation components of stress ...

XC contribution to stress (GPa): 
 439.518486800794733 0.000000000000000 0.000000000000000 
 0.000000000000000 439.518486800794733 0.000000000000000 
 0.000000000000000 0.000000000000000 439.518486800794733
Time for calculating exchange-correlation stress components: 3.618 ms
Start calculating local components of stress ...
time for sorting and interpolate pseudopotential: 94.273 ms, time for Allreduce/Reduce: 0.437 ms 

Electrostatics contribution to stress (GPa): 
 2107.532799467492168 -2.922745906479691 11.755931970700473 
 -2.922745906479691 2123.287733192804808 11.196775294694351 
 11.755931970700473 11.196775294694351 2125.032192956410654
Time for calculating local stress components: 1672.777 ms
Start calculating stress contributions from kinetic and nonlocal psp. 

Non-local contribution to stress (GPa): 
 188.186706135916893 -2.531688961136109 7.750267809934587 
 -2.531688961136109 197.714959751467006 7.503355349718457 
 7.750267809934587 7.503355349718457 204.559910165129196

Kinetic contribution to stress (GPa): 
 -2757.651649159719000 11.223831124802699 -22.560960429853829 
 11.223831124802699 -2784.900514786317217 -16.576428519121244 
 -22.560960429853829 -16.576428519121244 -2804.706005358511447
Time for calculating nonlocal+kinetic stress components: 278.438 ms

Electronic contribution to stress (GPa): 
 -22.413656755515152 5.769396257186899 -3.054760649218767 
 5.769396257186899 -24.379335041250815 2.123702125291564 
 -3.054760649218767 2.123702125291564 -35.595415436176133
The program took 32.646 s.
